<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style>
		#box{
			width: 1200px;
			height: 500px;
			border: 2px solid #002952;
			margin: 10px auto;
		}
			#div1{
				width: 96px;
				height: 96px;
				background: red;
				border: 2px solid red;
				position: absolute;		
				top: 10px;
				left: 30px;	
			}
			#div2{
				width: 96px;
				height: 96px;
				border: 2px solid blue;
				background: blue;
				position: absolute;
				top: 100px;
				left: 900px;
			}
			#box .border{
				border: 2px solid #000000;
				z-index: 10;
			}
		</style>
	</head>
	<body>
			<div id="div1">
			
			</div>
			<div id="div2">
				
			</div>
		
		<script type="text/javascript">
			var div3 = document.getElementById('div3')
			var Tab = function(obj){
				this.div = document.getElementById(obj);;
			}
			//点击拖拽
			Tab.prototype.down = function(){
				var that = this.div;
				var helf = this
				this.div.onmousedown = function(ev){
					ev = ev || event;
					var disx = ev.clientX - this.offsetLeft;
					var disy = ev.clientY - this.offsetTop;
					this.className = 'border';
					document.onmousemove = function(ev){
						ev = ev || event;
						that.style.left = ev.clientX - disx +'px';
						that.style.top = ev.clientY - disy+'px';
						helf.collide(helf);
						helf.boundary(box);
					}
					document.onmouseup = function(){
						document.onmousemove = null;
						that.className = '';
					}
					return false;
				}
			}
			//拖拽边界
			Tab.prototype.boundary = function(options){
				var boleft = this.div.offsetLeft;
				var botop = this.div.offsetTop;
				var opt = options || { }
				minx = opt.minx || 0;
				miny = opt.miny || 0;
				maxx = opt.maxx || window.innerWidth - this.div.offsetWidth;
				maxy = opt.maxy || window.innerHeight - this.div.offsetHeight;
				
				if(boleft >maxx){
					this.div.style.left = maxx +'px';
				}
				if(boleft <minx){
					this.div.style.left = minx +'px';
				}
				if(botop >maxy){
					this.div.style.top = maxy +'px';
				}
				if(botop <miny){
					this.div.style.top = miny +'px';
				}
			}
			
			//碰撞
			Tab.prototype.collide = function(obj1,obj2 ){
				if(obj1== tab1){
					obj1 = obj1.div;
					obj2 = obj2 ||tab2.div;
				}
				if(obj1== tab2){
					obj1 = obj1.div;
					obj2 = obj2 ||tab1.div;
				}
				if(divcollide(obj1,obj2)){
					obj1.style.background = 'yellow';
				}else{
					obj1.style.background = '';
				}
			}
			
			function divcollide(obj1,obj2){
				var pos1 = getPos(obj1);
				var pos2 = getPos(obj2);
				return !(pos1.bottom<pos2.top||pos1.left>pos2.right||pos1.top>pos2.bottom||pos1.right<pos2.left);
			}
			function getPos(obj){
				return obj.getBoundingClientRect();
				//获取 bottom top left right height width
			}
			//调用
			var box = document.getElementById('box')
			var tab1 = new Tab('div1');
			var tab2 = new Tab('div2');
			var box = {
				maxx: 1000,
				maxy: 200
				//minx : ,
				//miny : 
			}
			tab1.down();
			tab2.down();
			
		</script>
	</body>
</html>
